{"ast":null,"code":"import { EventEmitter } from '@angular/core';\nimport { Ware } from \"./ware\";\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"./ware.service\";\nimport * as i2 from \"@angular/common\";\nimport * as i3 from \"@angular/forms\";\nimport * as i4 from \"primeng/tree\";\nfunction WareEditComponent_option_16_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"option\", 18);\n    i0.ɵɵtext(1);\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const wareUnit_r1 = ctx.$implicit;\n    i0.ɵɵpropertyInterpolate(\"value\", wareUnit_r1.id);\n    i0.ɵɵadvance(1);\n    i0.ɵɵtextInterpolate(wareUnit_r1.label);\n  }\n}\nexport class WareEditComponent {\n  // selectedFile: TreeNode;\n  // baseInformationComponent: BaseInformationComponent;\n  constructor(wareService) {\n    this.wareService = wareService;\n    this.wareId = '';\n    this.editModeEmitter = new EventEmitter();\n    this.treeNode = [];\n    this.ware = new Ware();\n  }\n  ngOnInit() {\n    if (this.wareId != '') {\n      this.onLoad();\n    }\n    this.loadBaseInformation();\n  }\n  onLoad() {\n    this.ware = new Ware();\n    this.wareService.loadWare(this.wareId).subscribe(ware => {\n      this.ware = ware;\n    });\n  }\n  save() {\n    console.log(this.selectedFile);\n    // @ts-ignore\n    this.ware.typeTitle = this.selectedFile.label;\n    // @ts-ignore\n    this.ware.typeId = this.selectedFile.id;\n    console.log(this.ware);\n    this.wareService.saveWare(this.ware).subscribe(ware => {\n      success: {\n        this.switchToGrid();\n      }\n    });\n  }\n  switchToGrid() {\n    this.ware = new Ware();\n    this.editModeEmitter.emit(false);\n  }\n  loadBaseInformation() {\n    this.wareService.getAllBaseInformation().subscribe(baseInformations => {\n      this.wareUnits = baseInformations.filter(baseInformation => {\n        return baseInformation.parent === '0cd673ef-3d3c-43bc-b52a-254175a7f751';\n      });\n    });\n    this.wareService.getAllBaseInformation().subscribe(baseInformations => {\n      this.wareTypes = baseInformations.filter(baseInformation => {\n        // @ts-ignore\n        return baseInformation.hierarchy.search('002') === 0 && baseInformation.id !== 'f3f2644f-6fac-429b-b7cc-df1e2947b63e';\n      });\n      this.makeTreeJson(this.wareTypes);\n    });\n  }\n  makeTreeJson(baseInformations) {\n    let baseInformationHeaderFiltered = [];\n    baseInformationHeaderFiltered = baseInformations.filter((baseInformation, index) => {\n      baseInformation.hierarchy < 1000000 ? delete baseInformations[index] : null;\n      return baseInformation.hierarchy < 1000000;\n    });\n    baseInformationHeaderFiltered.forEach(baseInformationHeader => {\n      if (baseInformationHeader != undefined) this.getChild(baseInformationHeader, baseInformations);\n    });\n    this.treeNode = baseInformationHeaderFiltered;\n  }\n  getChild(baseInformationHeader, baseInformations) {\n    let baseInformationsTree = [];\n    baseInformationHeader.children = new Array();\n    baseInformations.filter(baseInformation => {\n      // @ts-ignore\n      if (baseInformation.hierarchy !== baseInformationHeader.hierarchy && baseInformation.hierarchy.search(baseInformationHeader.hierarchy) === 0 && baseInformationHeader.hierarchy.length + 3 === baseInformation.hierarchy.length) {\n        let bae = this.getChild(baseInformation, baseInformations);\n        // @ts-ignore\n        baseInformationHeader.children.push(bae[0]);\n      }\n    });\n    baseInformationsTree.push(baseInformationHeader);\n    return baseInformationsTree;\n  }\n}\nWareEditComponent.ɵfac = function WareEditComponent_Factory(t) {\n  return new (t || WareEditComponent)(i0.ɵɵdirectiveInject(i1.WareService));\n};\nWareEditComponent.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n  type: WareEditComponent,\n  selectors: [[\"app-ware-edit\"]],\n  inputs: {\n    wareId: \"wareId\"\n  },\n  outputs: {\n    editModeEmitter: \"editModeEmitter\"\n  },\n  decls: 34,\n  vars: 6,\n  consts: [[1, \"row\", \"m-0\", \"p-0\", \"col-12\", \"col-sm-12\"], [1, \"row\", \"m-0\", \"mt-3\", \"p-0\", \"col-6\", \"col-sm-6\"], [\"for\", \"\", 1, \"col-12\", \"col-sm-12\", \"control-label\", \"text-danger\"], [1, \"col-12\", \"col-sm-12\", \"form-control\", 3, \"ngModel\", \"ngModelChange\"], [\"selectionMode\", \"single\", 3, \"value\", \"selection\", \"selectionChange\"], [1, \"form-control\", 3, \"ngModel\", \"ngModelChange\"], [\"selected\", \"\", \"value\", \"0\"], [\"class\", \"\", 3, \"value\", 4, \"ngFor\", \"ngForOf\"], [\"for\", \"\", 1, \"col-12\", \"col-sm-12\", \"control-label\"], [\"type\", \"checkbox\", 3, \"ngModel\", \"ngModelChange\"], [1, \"row\", \"m-0\", \"mt-3\", \"p-0\", \"col-12\", \"col-sm-12\"], [2, \"width\", \"8rem\"], [1, \"btn\", \"btn-primary\", \"w-100\", 3, \"click\"], [1, \"fa\", \"fa-save\"], [1, \"btn\", \"btn-danger\", \"w-100\"], [1, \"fa\", \"fa-refresh\"], [1, \"btn\", \"btn-warning\", \"w-100\", 3, \"click\"], [1, \"fa\", \"fa-backspace\"], [1, \"\", 3, \"value\"]],\n  template: function WareEditComponent_Template(rf, ctx) {\n    if (rf & 1) {\n      i0.ɵɵelementStart(0, \"div\", 0)(1, \"div\", 1)(2, \"label\", 2);\n      i0.ɵɵtext(3, \"\\u0646\\u0627\\u0645 \\u06A9\\u0627\\u0644\\u0627\");\n      i0.ɵɵelementEnd();\n      i0.ɵɵelementStart(4, \"input\", 3);\n      i0.ɵɵlistener(\"ngModelChange\", function WareEditComponent_Template_input_ngModelChange_4_listener($event) {\n        return ctx.ware.name = $event;\n      });\n      i0.ɵɵelementEnd()();\n      i0.ɵɵelementStart(5, \"div\", 1)(6, \"label\", 2);\n      i0.ɵɵtext(7, \"\\u06AF\\u0631\\u0648\\u0647 \\u06A9\\u0627\\u0644\\u0627\");\n      i0.ɵɵelementEnd();\n      i0.ɵɵelementStart(8, \"p-tree\", 4);\n      i0.ɵɵlistener(\"selectionChange\", function WareEditComponent_Template_p_tree_selectionChange_8_listener($event) {\n        return ctx.selectedFile = $event;\n      });\n      i0.ɵɵelementEnd()()();\n      i0.ɵɵelementStart(9, \"div\", 0)(10, \"div\", 1)(11, \"label\", 2);\n      i0.ɵɵtext(12, \"\\u0648\\u0627\\u062D\\u062F \\u06A9\\u0627\\u0644\\u0627\");\n      i0.ɵɵelementEnd();\n      i0.ɵɵelementStart(13, \"select\", 5);\n      i0.ɵɵlistener(\"ngModelChange\", function WareEditComponent_Template_select_ngModelChange_13_listener($event) {\n        return ctx.ware.unitId = $event;\n      });\n      i0.ɵɵelementStart(14, \"option\", 6);\n      i0.ɵɵtext(15, \"\\u0648\\u0627\\u062D\\u062F \\u06A9\\u0627\\u0644\\u0627 \\u0631\\u0627 \\u0627\\u0646\\u062A\\u062E\\u0627\\u0628 \\u0646\\u0645\\u0627\\u06CC\\u06CC\\u062F\");\n      i0.ɵɵelementEnd();\n      i0.ɵɵtemplate(16, WareEditComponent_option_16_Template, 2, 2, \"option\", 7);\n      i0.ɵɵelementEnd()();\n      i0.ɵɵelementStart(17, \"div\", 1)(18, \"label\", 8);\n      i0.ɵɵtext(19, \"\\u0648\\u0636\\u0639\\u06CC\\u062A\");\n      i0.ɵɵelementEnd();\n      i0.ɵɵelementStart(20, \"input\", 9);\n      i0.ɵɵlistener(\"ngModelChange\", function WareEditComponent_Template_input_ngModelChange_20_listener($event) {\n        return ctx.ware.status = $event;\n      });\n      i0.ɵɵelementEnd()()();\n      i0.ɵɵelementStart(21, \"div\", 10)(22, \"span\", 11)(23, \"button\", 12);\n      i0.ɵɵlistener(\"click\", function WareEditComponent_Template_button_click_23_listener() {\n        return ctx.save();\n      });\n      i0.ɵɵtext(24, \" \\u062B\\u0628\\u062A \");\n      i0.ɵɵelement(25, \"i\", 13);\n      i0.ɵɵelementEnd()();\n      i0.ɵɵelementStart(26, \"span\", 11)(27, \"button\", 14);\n      i0.ɵɵtext(28, \" \\u0628\\u0627\\u0632\\u0646\\u0634\\u0627\\u0646\\u06CC \");\n      i0.ɵɵelement(29, \"i\", 15);\n      i0.ɵɵelementEnd()();\n      i0.ɵɵelementStart(30, \"span\", 11)(31, \"button\", 16);\n      i0.ɵɵlistener(\"click\", function WareEditComponent_Template_button_click_31_listener() {\n        return ctx.switchToGrid();\n      });\n      i0.ɵɵtext(32, \" \\u0628\\u0627\\u0632\\u06AF\\u0634\\u062A \");\n      i0.ɵɵelement(33, \"i\", 17);\n      i0.ɵɵelementEnd()()();\n    }\n    if (rf & 2) {\n      i0.ɵɵadvance(4);\n      i0.ɵɵproperty(\"ngModel\", ctx.ware.name);\n      i0.ɵɵadvance(4);\n      i0.ɵɵproperty(\"value\", ctx.treeNode)(\"selection\", ctx.selectedFile);\n      i0.ɵɵadvance(5);\n      i0.ɵɵproperty(\"ngModel\", ctx.ware.unitId);\n      i0.ɵɵadvance(3);\n      i0.ɵɵproperty(\"ngForOf\", ctx.wareUnits);\n      i0.ɵɵadvance(4);\n      i0.ɵɵproperty(\"ngModel\", ctx.ware.status);\n    }\n  },\n  dependencies: [i2.NgForOf, i3.NgSelectOption, i3.ɵNgSelectMultipleOption, i3.DefaultValueAccessor, i3.CheckboxControlValueAccessor, i3.SelectControlValueAccessor, i3.NgControlStatus, i3.NgModel, i4.Tree]\n});","map":null,"metadata":{},"sourceType":"module","externalDependencies":[]}