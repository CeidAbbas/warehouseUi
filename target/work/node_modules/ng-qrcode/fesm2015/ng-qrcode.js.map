{"version":3,"file":"ng-qrcode.js","sources":["../../../projects/ng-qrcode/src/lib/qr-code.component.ts","../../../projects/ng-qrcode/src/lib/qr-code.directive.ts","../../../projects/ng-qrcode/src/lib/qr-code.module.ts","../../../projects/ng-qrcode/src/public-api.ts","../../../projects/ng-qrcode/src/ng-qrcode.ts"],"sourcesContent":["import { Component, Input } from \"@angular/core\"\nimport { QrCodeErrorCorrectionLevel } from \"./types\"\n\n@Component({\n  selector: \"qr-code\",\n  template: `\n    <canvas *ngIf=\"value\"\n            [qrCode]=\"value\"\n            [qrCodeErrorCorrectionLevel]=\"errorCorrectionLevel\"\n            [qrCodeCenterImageSrc]=\"centerImageSrc\"\n            [qrCodeCenterImageWidth]=\"centerImageSize\"\n            [qrCodeCenterImageHeight]=\"centerImageSize\"\n            [qrCodeMargin]=\"margin\"\n            [width]=\"size\"\n            [height]=\"size\">\n    </canvas>\n  `,\n  styles: [],\n})\nexport class QrCodeComponent {\n\n  @Input()\n  value?: string\n\n  @Input()\n  size?: string | number\n\n  @Input()\n  errorCorrectionLevel?: QrCodeErrorCorrectionLevel\n\n  @Input()\n  centerImageSrc?: string\n\n  @Input()\n  centerImageSize?: string | number\n\n  @Input()\n  margin?: number\n\n}\n","import { Directive, Input, OnChanges, ViewContainerRef } from \"@angular/core\"\nimport qrcode from \"qrcode\"\nimport { QrCodeErrorCorrectionLevel } from \"./types\"\n\n@Directive({\n  // tslint:disable-next-line:directive-selector\n  selector: `canvas[qrCode]`,\n})\nexport class QrCodeDirective implements OnChanges {\n\n  static readonly DEFAULT_ERROR_CORRECTION_LEVEL: QrCodeErrorCorrectionLevel = \"M\"\n  static readonly DEFAULT_CENTER_IMAGE_SIZE = 40\n\n  // tslint:disable-next-line:no-input-rename\n  @Input(\"qrCode\") value!: string\n\n  // tslint:disable-next-line:no-input-rename\n  @Input(\"qrCodeVersion\") version?: number\n\n  // tslint:disable-next-line:no-input-rename\n  @Input(\"qrCodeErrorCorrectionLevel\") errorCorrectionLevel: QrCodeErrorCorrectionLevel = QrCodeDirective.DEFAULT_ERROR_CORRECTION_LEVEL\n\n  @Input() width?: number\n  @Input() height?: number\n\n  // tslint:disable-next-line:no-input-rename\n  @Input(\"qrCodeCenterImageSrc\") centerImageSrc?: string\n  // tslint:disable-next-line:no-input-rename\n  @Input(\"qrCodeCenterImageWidth\") centerImageWidth?: number | string\n  // tslint:disable-next-line:no-input-rename\n  @Input(\"qrCodeCenterImageHeight\") centerImageHeight?: number | string\n\n  // tslint:disable-next-line:no-input-rename\n  @Input(\"qrCodeMargin\") margin = 16\n\n  private centerImage?: HTMLImageElement\n\n  constructor(\n    private viewContainerRef: ViewContainerRef,\n  ) {\n  }\n\n  async ngOnChanges() {\n    if (!this.value) {\n      return\n    }\n\n    if (this.version && this.version > 40) {\n      console.warn(\"[qrCode] max version is 40, clamping\")\n      this.version = 40\n    } else if (this.version && this.version < 1) {\n      console.warn(\"[qrCode] min version is 1, clamping\")\n      this.version = 1\n    } else if (this.version !== undefined && isNaN(this.version)) {\n      console.warn(\"[qrCode] version should be set to a number, defaulting to auto\")\n      this.version = undefined\n    }\n\n    const canvas = this.viewContainerRef.element.nativeElement as HTMLCanvasElement | null\n\n    if (!canvas) {\n      // native element not available on server side rendering\n      return\n    }\n\n    const context = canvas.getContext(\"2d\")\n\n    if (context) {\n      context.clearRect(0, 0, context.canvas.width, context.canvas.height)\n    }\n\n    const errorCorrectionLevel = this.errorCorrectionLevel ?? QrCodeDirective.DEFAULT_ERROR_CORRECTION_LEVEL\n\n    await qrcode\n      .toCanvas(canvas, this.value, {\n        version: this.version,\n        errorCorrectionLevel,\n        width: this.width,\n        margin: this.margin,\n      })\n\n    const centerImageSrc = this.centerImageSrc\n    const centerImageWidth = getIntOrDefault(this.centerImageWidth, QrCodeDirective.DEFAULT_CENTER_IMAGE_SIZE)\n    const centerImageHeight = getIntOrDefault(this.centerImageHeight, QrCodeDirective.DEFAULT_CENTER_IMAGE_SIZE)\n\n    if (centerImageSrc && context) {\n\n      if (!this.centerImage) {\n        this.centerImage = new Image(centerImageWidth, centerImageHeight)\n      }\n\n      if (centerImageSrc !== this.centerImage?.src) {\n        this.centerImage.src = centerImageSrc\n      }\n\n      if (centerImageWidth !== this.centerImage.width) {\n        this.centerImage.width = centerImageWidth\n      }\n\n      if (centerImageHeight !== this.centerImage.height) {\n        this.centerImage.height = centerImageHeight\n      }\n\n      const centerImage = this.centerImage\n\n      centerImage.onload = () => {\n        context.drawImage(\n          centerImage,\n          canvas.width / 2 - centerImageWidth / 2,\n          canvas.height / 2 - centerImageHeight / 2, centerImageWidth, centerImageHeight,\n        )\n      }\n    }\n\n  }\n\n}\n\nfunction getIntOrDefault(value: string | number | undefined, defaultValue: number): number {\n  if (value === undefined || value === \"\") {\n    return defaultValue\n  }\n\n  if (typeof value === \"string\") {\n    return parseInt(value, 10)\n  }\n\n  return value\n}\n","import { CommonModule } from \"@angular/common\"\nimport { NgModule } from \"@angular/core\"\nimport { QrCodeComponent } from \"./qr-code.component\"\nimport { QrCodeDirective } from \"./qr-code.directive\"\n\n@NgModule({\n  declarations: [\n    QrCodeComponent,\n    QrCodeDirective,\n  ],\n  imports: [\n    CommonModule,\n  ],\n  exports: [\n    QrCodeComponent,\n    QrCodeDirective,\n  ],\n})\nexport class QrCodeModule {\n}\n","/*\n * Public API Surface of ng-qrcode\n */\n\nexport * from \"./lib/qr-code.component\"\nexport * from \"./lib/qr-code.directive\"\nexport * from \"./lib/qr-code.module\"\nexport * from \"./lib/types\"\n","/**\n * Generated bundle index. Do not edit.\n */\n\nexport * from './public-api';\n"],"names":[],"mappings":"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"}